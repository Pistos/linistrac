<?r if not @groups.empty? ?>
  <span class="group-selector #{@css_class}" id="#{@id}">
    <select name="group_id">
      <?r @groups.each do |g| ?>
        <option value="#{g.id}" #{g.id == @group_id ? 'selected' : '' }>#{g.name}</option>
      <?r end ?>
    </select>
    
    <?r @groups.each do |g| ?>
      #{
      render_template(
        'group_selector.xhtml',
        {
          :groups => g.children,
          :css_class => 'child-group',
          :id => "children-of-#{g.id}",
        }
      )
      }
    <?r end ?>
  </span>
<?r end ?>
