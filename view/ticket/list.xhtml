<h2>Tickets</h2>

<h4><a href="#" id="filter-toggle">Filter</a></h4>

<form method="POST" id="filter">

<table>

  <tr>
  <td>Statuses:</td>
  <td>
  <input type="checkbox" class="toggle-all" #{'checked' if @statuses == @selected[ :statuses ]}/>All
  <?r @statuses.each do |s| ?>
  <input type="checkbox" name="status-#{s.id}" #{'checked' if @selected[ :statuses ].include?( s )}>#{s}
  <?r end ?>
  </td>
  </tr>

  <tr>
  <td>Resolutions:</td>
  <td>
  <input type="checkbox" class="toggle-all" #{'checked' if @resolutions == @selected[ :resolutions ] }/>All
  <?r @resolutions.each do |s| ?>
  <input type="checkbox" name="resolution-#{s.id}" #{'checked' if @selected[ :resolutions ].include?( s )}>#{s}
  <?r end ?>
  </td>
  </tr>

  <tr>
  <td>Groups:</td>
  <td>
  <input type="checkbox" class="toggle-all" #{'checked' if @groups == @selected[ :groups ] }/>All
  <?r @groups.each do |s| ?>
  <input type="checkbox" name="group-#{s.id}" #{'checked' if @selected[ :groups ].include?( s )}>#{s}
  <?r end ?>
  </td>
  </tr>

</table>

<input type="submit" value="Filter"/>

</form>

<table class="list sortable" id="ticket-list">

  <thead>
  <tr>
    <th>ID</th>
    <th>Title</th>
    <th>Severity</th>
    <th>Priority</th>
    <th>Creator</th>
    <th>Updated</th>
    <th>Group</th>
    <th>Status</th>
    <th>Resolution</th>
  </tr>
  </thead>

  <tbody>
<?r @tickets.each_with_index do |ticket,i| ?>

  <tr>
    <td><a href="/ticket/view/#{ticket.id}">#{ticket.id}</a></td>
    <td><a href="/ticket/view/#{ticket.id}">#{ticket.title}</a></td>
    <td>#{ticket.severity}</td>
    <td>#{ticket.priority}</td>
    <td>#{ticket.creator ? ticket.creator.username : 'Anonymous'}</td>
    <td>#{ticket.time_updated_s}</td>
    <td><a href="/ticket/list/#{ticket.group}">#{ticket.group}</a></td>
    <td>#{ticket.status}</td>
    <td>#{ticket.resolution}</td>
  </tr>

<?r end ?>
  </tbody>

</table>